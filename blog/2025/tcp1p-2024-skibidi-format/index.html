<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> TCP1P 2024 - Skibidi Format | Joshua R. Sylvester </title> <meta name="author" content="Joshua R. Sylvester"> <meta name="description" content="Write up from the TCP1P 2024 CTF competition"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.png?caebac7e1dc792c0cd262ee032d8e29f"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jsylvester.com/blog/2025/tcp1p-2024-skibidi-format/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Joshua</span> R. Sylvester </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/news/">news </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">TCP1P 2024 - Skibidi Format</h1> <p class="post-meta"> Created on September 13, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/forensics"> <i class="fa-solid fa-hashtag fa-sm"></i> forensics</a>   ·   <a href="/blog/category/write-ups"> <i class="fa-solid fa-tag fa-sm"></i> write-ups</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <ul> <li>CTF: TCP1P 2024</li> <li>Challenge Name: Skibidi Format</li> <li>Category: Forensics</li> <li>Difficulty: Unknown</li> </ul> <h2 id="synopsis">Synopsis</h2> <p>The solution involves reading a <code class="language-plaintext highlighter-rouge">.skibidi</code> file, extracting the header metadata, decrypting the compressed pixel data using AES-256-GCM, and decompressing it with Zstandard. The pixel data is then reconstructed into an image using the <code class="language-plaintext highlighter-rouge">PIL</code> library, based on the specified number of colour channels.</p> <h2 id="description">Description</h2> <p>So my friend just made a new image format and asked me to give him a test file, so I gave him my favorite png of all time. But the only thing I receive back is just my image with his new format and its “specification” file, don’t know what that is. Can you help me read this file?</p> <h2 id="challenge">Challenge</h2> <p>The challenge contains two files:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">spec.html</code>: This is a file describing the detail of the new photo format</li> <li> <code class="language-plaintext highlighter-rouge">suisei.skibidi</code> This is the picture in the format specified by the <code class="language-plaintext highlighter-rouge">spec.html</code> file</li> </ul> <h3 id="file-format-specification">File Format Specification</h3> <p>Based on the <code class="language-plaintext highlighter-rouge">spec.html</code> a <code class="language-plaintext highlighter-rouge">.skibidi</code> file consists of two main sections:</p> <ol> <li> <strong>Header</strong>: Contains metadata about the image, such as dimensions, colour channels, compression method, and encryption details.</li> <li> <strong>Data Section</strong>: Holds the encrypted and compressed pixel data. <h4 id="header-structure">Header Structure</h4> </li> </ol> <p>The header has a fixed size of 58 bytes and includes the following fields:</p> <p>| Offset | Field | Size (bytes) | Description | <br> | —— | ———— | ———— | ————————————— | | 0 | Magic Number | 4 | Identifier (“SKB1”) for the file format | <br> | 4 | Width | 4 | Image width in pixels | <br> | 8 | Height | 4 | Image height in pixels | <br> | 12 | Color Channels | 1 | Number of color channels (1 = Grayscale, 3 = RGB, 4 = RGBA) | | 13 | Compression ID | 1 | Compression algorithm identifier (1 = Zstandard) | <br> | 14 | AES Key | 32 | AES-256 encryption key | <br> | 46 | AES Initialization Vector (IV) | 12 | AES-GCM IV | |</p> <h4 id="data-section">Data Section</h4> <p>The pixel data is encrypted and compressed, following these steps:</p> <ol> <li> <strong>Compression</strong>: Pixel data is compressed using the specified compression algorithm (currently, Zstandard).</li> <li> <strong>Encryption</strong>: Compressed data is encrypted using AES-256-GCM with the provided key and IV.</li> </ol> <h2 id="solution">Solution</h2> <p>To solve this problem, we need to:</p> <ol> <li>Read the <code class="language-plaintext highlighter-rouge">.skibidi</code> file, extracting header information.</li> <li>Decrypt the encrypted data using the AES key and IV.</li> <li>Decompress the decrypted data using the specified compression method.</li> <li>Reconstruct the image using the decompressed pixel data.</li> </ol> <h3 id="step-1-importing-required-libraries">Step 1. Importing Required Libraries</h3> <p>The necessary libraries are imported, including <code class="language-plaintext highlighter-rouge">struct</code> for reading binary data, <code class="language-plaintext highlighter-rouge">Cryptodome.Cipher</code> for AES decryption, <code class="language-plaintext highlighter-rouge">zstandard</code> for decompression, and <code class="language-plaintext highlighter-rouge">PIL</code> and <code class="language-plaintext highlighter-rouge">numpy</code> for image manipulation.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">struct</span>
<span class="kn">from</span> <span class="n">Cryptodome.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">import</span> <span class="n">zstandard</span> <span class="k">as</span> <span class="n">zstd</span>
<span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
</code></pre></div></div> <h3 id="step-2-reading-the-skibidi-file">Step 2. Reading the <code class="language-plaintext highlighter-rouge">.skibidi</code> File</h3> <p>The <code class="language-plaintext highlighter-rouge">read_skibidi_file</code> function takes the file path of a <code class="language-plaintext highlighter-rouge">.skibidi</code> file, opens it in binary mode, and reads the header to extract metadata such as image dimensions, colour channels, compression method, and encryption details.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read_skibidi_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># Read header
</span>        <span class="n">magic</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">magic</span> <span class="o">!=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">SKB1</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">Invalid file format</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="n">width</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="nf">unpack</span><span class="p">(</span><span class="sh">'</span><span class="s">&lt;I</span><span class="sh">'</span><span class="p">,</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="nf">unpack</span><span class="p">(</span><span class="sh">'</span><span class="s">&lt;I</span><span class="sh">'</span><span class="p">,</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="nf">unpack</span><span class="p">(</span><span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">,</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">compression_id</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="nf">unpack</span><span class="p">(</span><span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">,</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">aes_key</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
        <span class="n">aes_iv</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
        
        <span class="c1"># Read encrypted data
</span>        <span class="n">encrypted_data</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
        <span class="bp">...</span>

</code></pre></div></div> <p>When running this code and printing out the values for width, height, channels and compression_id you get the following output :</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Width 3840 - height 2160 - channels  4 - compression 1
</code></pre></div></div> <p>These values will be useful in the future when it comes to converting the data into an image, the compression method is also using Zstandard which is the only method supported based on the specification.</p> <h3 id="step-3-decrypting-the-pixel-data">Step 3. Decrypting the Pixel Data</h3> <p>Using the AES-256-GCM algorithm, the encrypted pixel data is decrypted with the extracted key and IV from the header. This step ensures data confidentiality and integrity.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>		<span class="bp">...</span>
        <span class="c1"># Decrypt the data
</span>        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">aes_key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_GCM</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">aes_iv</span><span class="p">)</span>
        <span class="n">decrypted_data</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">)</span>
        <span class="bp">...</span>

</code></pre></div></div> <h3 id="step-4-decompressing-the-data">Step 4. Decompressing the Data</h3> <p>The decompressed pixel data is obtained using the Zstandard library, based on the specified compression method in the header. Error handling ensures that decompression issues are reported.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>		<span class="bp">...</span>
        <span class="c1"># Decompress the data
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="n">dctx</span> <span class="o">=</span> <span class="n">zstd</span><span class="p">.</span><span class="nc">ZstdDecompressor</span><span class="p">()</span>
            <span class="n">pixel_data</span> <span class="o">=</span> <span class="n">dctx</span><span class="p">.</span><span class="nf">decompress</span><span class="p">(</span><span class="n">decrypted_data</span><span class="p">,</span> <span class="n">max_output_size</span><span class="o">=</span><span class="mi">100000000</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">zstd</span><span class="p">.</span><span class="n">ZstdError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Decompression failed:</span><span class="sh">"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">An error occurred:</span><span class="sh">"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
        
        <span class="c1"># Return the extracted data
</span>        <span class="k">return</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">compression_id</span><span class="p">,</span> <span class="n">pixel_data</span>
</code></pre></div></div> <h3 id="step-5-reconstructing-the-image">Step 5. Reconstructing the Image</h3> <p>The image is reconstructed from the decompressed pixel data. Since the number of channels is 4, the pixel data is reshaped accordingly. The <code class="language-plaintext highlighter-rouge">PIL</code> library is used to convert the array into an image and save or display it.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">compression</span><span class="p">,</span> <span class="n">pixel_data</span> <span class="o">=</span> <span class="nf">read_skibidi_file</span><span class="p">(</span><span class="sh">"</span><span class="s">./suisei.skibidi</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Width </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s"> - height </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s"> - channels  </span><span class="si">{</span><span class="n">channels</span><span class="si">}</span><span class="s"> - compression </span><span class="si">{</span><span class="n">compression</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="n">width</span> <span class="o">=</span> <span class="mi">3840</span>  
<span class="n">height</span> <span class="o">=</span> <span class="mi">2160</span>  
<span class="n">rgba_data</span> <span class="o">=</span> <span class="n">pixel_data</span> 

<span class="c1"># Convert byte array to a NumPy array
</span><span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">frombuffer</span><span class="p">(</span><span class="n">rgba_data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">).</span><span class="nf">reshape</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># Create an image from the array
</span><span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">fromarray</span><span class="p">(</span><span class="n">image_array</span><span class="p">,</span> <span class="sh">'</span><span class="s">RGBA</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Save or display the image
</span><span class="n">image</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">'</span><span class="s">output_image.png</span><span class="sh">'</span><span class="p">)</span>
<span class="n">image</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <h3 id="summary">Summary</h3> <p>The solution shows how to read the <code class="language-plaintext highlighter-rouge">.skibidi</code> file format by:</p> <ol> <li>Extracting metadata from the header.</li> <li>Decrypting and decompressing the pixel data.</li> <li>Reconstructing the image using <code class="language-plaintext highlighter-rouge">PIL</code> based on the colour channels.</li> </ol> <h3 id="output">Output</h3> <p>The output for this code is an image where the photo contains the flag.</p> <p><img src="/assets/img/posts/tcp1p-2024-skibidi-format/output_image.png" alt=""></p> <h2 id="solution-code">Solution Code</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">struct</span>
<span class="kn">from</span> <span class="n">Cryptodome.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">import</span> <span class="n">zstandard</span> <span class="k">as</span> <span class="n">zstd</span>
<span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">def</span> <span class="nf">read_skibidi_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># Read header
</span>        <span class="n">magic</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">magic</span> <span class="o">!=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">SKB1</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">Invalid file format</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="n">width</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="nf">unpack</span><span class="p">(</span><span class="sh">'</span><span class="s">&lt;I</span><span class="sh">'</span><span class="p">,</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="nf">unpack</span><span class="p">(</span><span class="sh">'</span><span class="s">&lt;I</span><span class="sh">'</span><span class="p">,</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="nf">unpack</span><span class="p">(</span><span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">,</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">compression_id</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="nf">unpack</span><span class="p">(</span><span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">,</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">aes_key</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
        <span class="n">aes_iv</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
        
        <span class="c1"># Read encrypted data
</span>        <span class="n">encrypted_data</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>

        <span class="c1"># Decrypt the data
</span>        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">aes_key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_GCM</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">aes_iv</span><span class="p">)</span>
        <span class="n">decrypted_data</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">encrypted_data</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">decrypted_data</span><span class="p">))</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">decrypted_data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
        <span class="c1"># Decompress the data
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="n">dctx</span> <span class="o">=</span> <span class="n">zstd</span><span class="p">.</span><span class="nc">ZstdDecompressor</span><span class="p">()</span>
            <span class="n">pixel_data</span> <span class="o">=</span> <span class="n">dctx</span><span class="p">.</span><span class="nf">decompress</span><span class="p">(</span><span class="n">decrypted_data</span><span class="p">,</span> <span class="n">max_output_size</span><span class="o">=</span><span class="mi">100000000</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">zstd</span><span class="p">.</span><span class="n">ZstdError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Decompression failed:</span><span class="sh">"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">An error occurred:</span><span class="sh">"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        
        <span class="c1"># Interpret pixel data based on channels
</span>        <span class="k">return</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">compression_id</span><span class="p">,</span> <span class="n">pixel_data</span>

<span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">compression</span><span class="p">,</span> <span class="n">pixel_data</span> <span class="o">=</span> <span class="nf">read_skibidi_file</span><span class="p">(</span><span class="sh">"</span><span class="s">./suisei.skibidi</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Width </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s"> - height </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s"> - channels  </span><span class="si">{</span><span class="n">channels</span><span class="si">}</span><span class="s"> - compression </span><span class="si">{</span><span class="n">compression</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="n">width</span> <span class="o">=</span> <span class="mi">3840</span>  
<span class="n">height</span> <span class="o">=</span> <span class="mi">2160</span>  
<span class="n">rgba_data</span> <span class="o">=</span> <span class="n">pixel_data</span> 

<span class="c1"># Convert byte array to a NumPy array
</span><span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">frombuffer</span><span class="p">(</span><span class="n">rgba_data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">).</span><span class="nf">reshape</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># Create an image from the array
</span><span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">fromarray</span><span class="p">(</span><span class="n">image_array</span><span class="p">,</span> <span class="sh">'</span><span class="s">RGBA</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Save or display the image
</span><span class="n">image</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">'</span><span class="s">output_image.png</span><span class="sh">'</span><span class="p">)</span>
<span class="n">image</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/htb-weak-rsa/">Hack The Box - Weak RSA</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/tcp1p-2024-imperfect-guesser/">TCP1P 2024 - Imperfect Guesser</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Joshua R. Sylvester. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>